name: deadlydog
date: '2015-01-24 12:29:57'
url: 'http://www.danskingdom.com'
message: "<a href=\"#comment-331859\" rel=\"nofollow\">@Eric </a> \r\nYeah, you had probably already ran the code that defined the Read-FolderBrowserDialog function, so the function was defined in your powershell session, even if you removed the actual code from your script.  Then once you closed your powershell window then your session ended.  All you need to do is put the function code at the top of your script.\r\n\r\ne.g.\r\n\r\n# Show an Open Folder Dialog and return the directory selected by the user.\r\nfunction Read-FolderBrowserDialog([string]$Message, [string]$InitialDirectory, [switch]$NoNewFolderButton)\r\n{\r\n    $browseForFolderOptions = 0\r\n    if ($NoNewFolderButton) { $browseForFolderOptions += 512 }\r\n \r\n    $app = New-Object -ComObject Shell.Application\r\n    $folder = $app.BrowseForFolder(0, $Message, $browseForFolderOptions, $InitialDirectory)\r\n    if ($folder) { $selectedDirectory = $folder.Self.Path } else { $selectedDirectory = '' }\r\n    [System.Runtime.Interopservices.Marshal]::ReleaseComObject($app) > $null\r\n    return $selectedDirectory\r\n}\r\n\r\n#Opens file directory search\r\n$directoryPath = Read-FolderBrowserDialog -Message “Please select a directory” -InitialDirectory ‘S:\\Projects\\UCG\\Production\\’ -NoNewFolderButton\r\nif (![string]::IsNullOrEmpty($directoryPath)) { Write-Host “You selected the directory: $directoryPath” }\r\nelse { “You did not select a directory.” }\r\n\r\n#Search files within directory\r\nREST OF SCRIPT…….."
email: c8addda594c8b338f1e3934e73505d0c
