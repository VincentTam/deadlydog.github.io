name: Ritash Koul
date: '2019-03-05 04:40:05'
url: ''
message: "Question:\r\n\r\nI have a windows service which is consuming a messaging system(Kafka) to fetch messages. I have to use an existing callback mechanism with the help of Timer class which helps me to check the message after some fixed time to fetch and process. Previously, the service is processing the message one by one. But I want after the message arrives the processing mechanism to execute in parallel. So if the first message arrived it should go for processing on one task and even if the processing is not finished for the first message still after the interval time configured using the callback method (callback is working now) next message should be picked and processed on a different task. In my case I dont have to use WaitAll because the messages will be independent of each other. Till now I am using the below code:\r\n\r\n  private static void Main()\r\n        {\r\n            try\r\n            {\r\n                int taskCount = 5;\r\n                Task.Factory.StartNewAsync(() =&gt;\r\n                {\r\n                   Subscriber consumer = new \r\n                   Subcriber()\r\n                   {\r\n                       Interval = 1000\r\n                    };\r\n\r\n                   consumer.CallBack(Process, msg =&gt; msg!= \r\n                   null);\r\n                 }, taskCount);\r\n                Console.ReadLine();\r\n              }\r\n             catch (Exception e)\r\n            {\r\n                 Console.WriteLine(e.Message);\r\n            }\r\n\r\n            public static void StartNewAsync(this TaskFactory \r\n            target, Action action, int taskCount)\r\n           {\r\n                 var tasks = new Task[taskCount];\r\n                 for (int i = 0; i &lt; taskCount; i++)\r\n                 {\r\n                      tasks[i] = target.StartNew(action);\r\n                 }\r\n             }\r\n\r\n             public static void Process(Message message)\r\n            {\r\n                 if (message != null)\r\n                {\r\n\r\n                 }\r\n                else\r\n                { }\r\n             }\r\n        }\r\n\r\nBut my problem is I want to know which task id picks the message after a message is received in the method Process(CDC message)?"
email: 5776344a767795beac497340696e6231
