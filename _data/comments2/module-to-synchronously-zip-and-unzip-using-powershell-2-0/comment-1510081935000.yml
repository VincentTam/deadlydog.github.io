name: Frank
date: '2017-11-07 13:12:15'
url: ''
message: "I found another approach which works for both PowerShell 2 and 3.\r\n\r\nfunction Unzip-File($file, $destination)\r\n{\r\n    $shell = new-object -com shell.application\r\n    $zip = $shell.NameSpace($file)\r\n    foreach($item in $zip.items())\r\n    {\r\n        $shell.Namespace($destination).copyhere($item)\r\n    }\r\n}\r\n\r\n\r\nfunction Zip-File($srcdir, $zipFilename, $zipFilepath)\r\n{\r\n\r\nif ($zipFilename -ne $null -and $zipFilepath -ne $null)\r\n{\r\n    $zipFile = \"$zipFilepath$zipFilename\"\r\n\r\n    #Prepare zip file\r\n    if(-not (test-path($zipFile))) \r\n    {\r\n        set-content $zipFile (\"PK\" + [char]5 + [char]6 + (\"$([char]0)\" * 18))\r\n        (dir $zipFile).IsReadOnly = $false  \r\n    }\r\n\r\n    $shellApplication = new-object -com shell.application\r\n    $zipPackage = $shellApplication.NameSpace($zipFile)\r\n    $files = Get-ChildItem -Path $srcdir | where{! $_.PSIsContainer}\r\n\r\n    foreach($file in $files) \r\n    { \r\n        $zipPackage.CopyHere($file.FullName)\r\n        #using this method, sometimes files can be 'skipped'\r\n        #this 'while' loop checks each file is added before moving to the next\r\n        while($zipPackage.Items().Item($file.name) -eq $null)\r\n        {\r\n            Start-sleep -seconds 1\r\n        }\r\n    }\r\n}\r\n\r\n}"
email: 46f78ff28ba8ae2ab52c8ad65873bd60
