name: Brooks Vaughn
date: '2015-07-01 14:47:16'
url: ''
message: "I developed a script that uses the Application.Shellâ€™s Copyhere() method to extract zip files. The script works perfectly when running directly with PowerShell.\r\n\r\nI created a Scheduler Task to run it and the script runs but the Copyhere() method fails to extract any zip files. It's not a permissions issue as the script has no problems creating folders, copying files, creating logfiles, etc... Only the Copyhere() does not produce any results, no errors, no exceptions, no std out, etc....\r\n\r\nAny thoughts?\r\n\r\nFor those how are interested, I am executing the Scheduler Task that runs on Windows 2008 R2 server as follows:\r\n\r\nUsing NETWORK_SERVICE for the User Account, Selecting \"Run whenever user is logged on or not\", Run with Highest Privileges\r\n\r\nAction: Start a Program\r\nProgram/Script: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nAdd Arguments: -Version 2 -ExecutionPolicy Bypass -NoProfile -NoLogo -NonInteractive -WindowStyle Hidden -Command \"\" 2&gt;&amp;1&gt;&gt; \"D:\\Utilities\\Salt_Scripts\\SALTARS_Daily_Cleanup_Task.log\"\r\n\r\nStart In: D:\\Utilities\\Salt_Scripts\r\n\r\nNETWORK_SERVICE has full rights to D:\\Utilities\\Salt_Scripts\\ and to D:\\wwwlogs and their subfolders\r\n\r\n\r\nSample Log Output looks like this:\r\n\r\n07/01/2015 15:19:26 ============================================================\r\n07/01/2015 15:19:26  Run Script Log File for Script: (LogFileCleanup_v1.1)\r\n07/01/2015 15:19:26           Started processing at: [07/01/2015 15:19:26]\r\n07/01/2015 15:19:26 ============================================================\r\n07/01/2015 15:19:26       Script Running on: MATLKSRT1APS002\r\n07/01/2015 15:19:26       Current Directory: D:\\Utilities\\Salt_Scripts\r\n07/01/2015 15:19:26     Calling Script File: D:\\Utilities\\Salt_Scripts\\wwwlogsCleanup.ps1\r\n07/01/2015 15:19:26      Script Output File: D:\\Utilities\\Salt_Scripts\\wwwlogsCleanup.log\r\n07/01/2015 15:19:26           Script Folder: D:\\Utilities\\Salt_Scripts\r\n07/01/2015 15:19:26     Temp Working Folder: D:\\Utilities\\Salt_Scripts\\Temp\r\n07/01/2015 15:19:26       Profile Temp Path: C:\\Windows\\ServiceProfiles\\NetworkService\\AppData\\Local\\Temp\\\r\n07/01/2015 15:19:26  \r\n07/01/2015 15:19:26 Parameter Values Passed In as Arguments:\r\n07/01/2015 15:19:26 \r\nKey                  Value                         \r\n---                  -----                         \r\nLogpath              D:\\wwwlogs                    \r\nLogPattern           *.log*                        \r\nArchiveAge           9                             \r\nArchiveNamingPattern SavedLogs_*.zip               \r\nLogFileAge           45                            \r\nLogMethod            File                          \r\nTempFolder           D:\\Utilities\\Salt_Scripts\\Temp\r\n07/01/2015 15:19:26  \r\n07/01/2015 15:19:26   Start of Current Month: 07/01/2015\r\n07/01/2015 15:19:26  Start of Previous Month: 06/01/2015\r\n07/01/2015 15:19:26  Retain Files Since Date: 05/17/2015 Using Log File Pattern (*.log*)\r\n07/01/2015 15:19:26 Delete Date for Archives: 10/01/2014 Using Archive File Pattern (SavedLogs_*.zip)\r\n07/01/2015 15:19:26          Log File Folder: D:\\wwwlogs\r\n07/01/2015 15:19:26  \r\n07/01/2015 15:19:26 Processing Search and Aging of Archive Files...\r\n07/01/2015 15:19:26 Found 42 logs earlier than 05/17/2015\r\n07/01/2015 15:19:27 Using Existing Zip file (D:\\wwwlogs\\logs\\logfiles\\W3SVC2\\SavedLogs_W3SVC2_2015-05.zip) which contains (15) files\r\n07/01/2015 15:19:27 File (u_ex150501.log) Already Exists in SavedLogs_W3SVC2_2015-05.zip... Checking log file is a Duplicate by extracting existing log from archive and comparing before deleting or renaming then adding to archive if different.\r\n07/01/2015 15:19:27 Extracting (D:\\Utilities\\Salt_Scripts\\Temp\\pdzqndfm.mji\\u_ex150501.log), CopyFlag: 0x61c\r\n07/01/2015 15:19:27 Temporary Folder: D:\\Utilities\\Salt_Scripts\\Temp\\pdzqndfm.mji\r\n07/01/2015 15:20:27 IsFileLocked() - Warning: File Not Found (D:\\Utilities\\Salt_Scripts\\Temp\\pdzqndfm.mji\\u_ex150501.log)\r\n07/01/2015 15:20:27 Zip-FileList Added (0) files\r\n07/01/2015 15:20:27 Zipped count: 0"
email: aabc341dc81034e1b04d39ab1ca43127
