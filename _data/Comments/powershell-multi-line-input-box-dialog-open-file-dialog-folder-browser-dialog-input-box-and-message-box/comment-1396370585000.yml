name: SeanD
date: '2014-04-01 10:43:05'
url: ''
message: "Not sure how to insert this into my script. I have a script that looks at a text file (pc names), ping them and exports to a csv with the responses. Script work fine.\r\n I would like to prompt the user fot the text file instead of having the path hard coded.\r\nI tried pasting your sample variable $filepath in front of my code but it says i did not pick a file.\r\n\r\n$filePath = Read-OpenFileDialog -WindowTitle \"Select Text File Example\" -InitialDirectory 'C:\\' -Filter \"Text files (*.txt)|*.txt\"\r\nif (![string]::IsNullOrEmpty($filePath)) { Write-Host \"You selected the file: $filePath\" }\r\nelse { \"You did not select a file.\" }\r\nget-content $filePath\r\n\r\n$Output2 = \"c:\\PSexport\\PingOldPCs5.csv\"\r\n\r\nWrite-host `\r\n\t\"Pinging List of Dead Computers and Writing to c:\\Psexport\\PingPC.csv `n WAIT\" -foregroundcolor \"green\"\r\n$filePath | ForEach-Object {GWMI win32_pingstatus -filter (\"address='\"+ $_ +\"'\") -computername .} | Select-Object ProtocolAddress,address,responsetime,statuscode | export-csv $Output2 -NoTypeInformation\r\nc:\\PSexport\\PingOldPCs5.csv"
email: a2d4772476e8230be0e1e56bc470b635
