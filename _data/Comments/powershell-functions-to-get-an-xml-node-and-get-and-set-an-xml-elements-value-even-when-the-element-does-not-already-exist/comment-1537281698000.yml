name: Steven
date: '2018-09-18 08:41:38'
url: ''
message: "Hello,\r\n\r\nMany thanks for this job ! It helps me so much.\r\nBased on your function, i'm using Set-XmlElementsAttributeValue. for example :\r\n\r\n$XMLfile = \"F:\\Deploy\\Control\\toto.xml\"\r\n\r\n# Use Get-Content to load the ts.xml file as a XML object\r\n[ xml ]$XMLContent = Get-Content -Path $XMLfile\r\n\r\nGet-XmlNode -XmlDocument $XMLContent -NodePath \"step\"\r\n\r\n\r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step\" -AttributeName \"type\" -AttributeValue \"SMS_TaskSequence_SetVariableAction\" \r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step\" -AttributeName \"name\" -AttributeValue \"[SG] - Set OSDisk\"\r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step\" -AttributeName \"description\" -AttributeValue \"For Preload OEM TS\"\r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step\" -AttributeName \"disable\" -AttributeValue \"false\"\r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step\" -AttributeName \"successCodeList\" -AttributeValue \"0 3010\"\r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step.defaultVarList\"\r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step.defaultVarList.variable\" -AttributeName \"name\" -AttributeValue \"VariableName\"\r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step.defaultVarList.variable\" -AttributeName \"property\" -AttributeValue \"VariableName\"\r\nSet-XmlElementsAttributeValue -XmlDocument $XMLContent -ElementPath \"package.step.defaultVarList\"\r\n\r\nbut in my case, i'm working with MDT and the TS.xml looks like bellow :\r\n\r\n    \r\n      \r\n        OSDisk\r\n        C:\r\n      \r\n      cscript.exe \"%SCRIPTROOT%\\ZTISetVariable.wsf\"\r\n    \r\n\r\nI trying to use your function to solve my problem, but no result.\r\n2 ElementPath are Variable.\r\n\r\nThen i would like to \"InsertBefore\" or \"InsertAfter\" my node step between other node.\r\nI have not already take a look on it. i keep you inform.\r\n        OSDisk\r\n        C:\r\n\r\nIf i run the function the first line will be overwrite by the second.\r\nDo you have an idea ?"
email: 9cf83cfd49c902fbfd15aae98d57df12
