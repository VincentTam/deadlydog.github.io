name: deadlydog
date: '2014-04-15 15:02:40'
url: 'http://www.danskingdom.com'
message: "<a href=\"#comment-67134\" rel=\"nofollow\">@Mike </a> \r\nThis problem is slightly off-topic and better suited for Stack Overflow, as it is more along the lines of \"how to execute PowerShell code from within a batch file\", but I'll take a whack at it. Just from looking at what you have here, the problem is likely that you need to pass your PowerShell command via the actual -Command switch, so something like this:\r\n\r\nPowershell -Command {New-ADGroup -Name “%Prefix%-OWA Test” -SamAccountName “%Prefix%-OWA Test” -GroupCategory Security -GroupScope Global -path “OU=%OU%,OU=Test1,DC=Test2,DC=Test3,DC=Test4,DC=com”}\r\n\r\nFrom the command prompt just type \"PowerShell /?\" to get more info on passing parameters to the PowerShell.exe executable.\r\n\r\nOr a hackier way might be to do something like this, which starts up a new powershell session then simulates you typing the command into the console and hitting enter:\r\n\r\nECHO New-ADGroup -Name “%Prefix%-OWA Test” -SamAccountName “%Prefix%-OWA Test” -GroupCategory Security -GroupScope Global -path “OU=%OU%,OU=Test1,DC=Test2,DC=Test3,DC=Test4,DC=com” | PowerShell\r\n\r\nI hope one of those solutions works for you."
email: c8addda594c8b338f1e3934e73505d0c
