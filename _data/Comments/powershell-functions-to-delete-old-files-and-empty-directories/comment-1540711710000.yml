name: Hardik Thaker
date: '2018-10-28 01:28:30'
url: ''
message: "Seems like \"-Recurse\" switch should not be there at first line of \"Remove-EmptyDirectories\" Function, because it will lead to below error \r\n\r\n\"Get-ChildItem : Could not find a part of the path \\\\xyz\\abc\\pqr.\"\r\n\r\nand anyway you have \"-Recurse\" at the same line which will not make any difference.\r\n\r\n\"| Where-Object { $_.PSIsContainer -and (Get-ChildItem -Path $_.FullName -Recurse -Force | Where-Object { !$_.PSIsContainer }) -eq $null } |\" \r\n\r\nIn short:\r\n\r\nCorrect :\r\n\r\nfunction Remove-EmptyDirectories([parameter(Mandatory=$true)][ValidateScript({Test-Path $_})][string] $Path, [switch] $DeletePathIfEmpty, [DateTime] $OnlyDeleteDirectoriesCreatedBeforeDate = [DateTime]::MaxValue, [DateTime] $OnlyDeleteDirectoriesNotModifiedAfterDate = [DateTime]::MaxValue, [switch] $OutputDeletedPaths, [switch] $WhatIf)\r\n{\r\n    Get-ChildItem -Path $Path -Force | Where-Object { $_.PSIsContainer -and (Get-ChildItem -Path $_.FullName -Recurse -Force | Where-Object { !$_.PSIsContainer }) -eq $null } | \r\n        Where-Object { $_.CreationTime -lt $OnlyDeleteDirectoriesCreatedBeforeDate -and $_.LastWriteTime -lt $OnlyDeleteDirectoriesNotModifiedAfterDate } | \r\n        ForEach-Object { if ($OutputDeletedPaths) { Write-Output $_.FullName } Remove-Item -Path $_.FullName -Force -WhatIf:$WhatIf }\r\n \r\n    # If we should delete the given path when it is empty, and it is a directory, and it is empty, and it meets the date requirements, then delete it.\r\n    if ($DeletePathIfEmpty -and (Test-Path -Path $Path -PathType Container) -and (Get-ChildItem -Path $Path -Force) -eq $null -and\r\n        ((Get-Item $Path).CreationTime -lt $OnlyDeleteDirectoriesCreatedBeforeDate) -and ((Get-Item $Path).LastWriteTime -lt $OnlyDeleteDirectoriesNotModifiedAfterDate))\r\n    { if ($OutputDeletedPaths) { Write-Output $Path } Remove-Item -Path $Path -Force -WhatIf:$WhatIf }\r\n}"
email: ac7e81899c8ed4dbb992c0ef4b93dd00
